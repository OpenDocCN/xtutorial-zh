# 选择数据库框架

> 原文：<https://asp.mvc-tutorial.com/working-with-databases/picking-a-database-framework/>

回到过去，PHP 和 ASP Classic 统治着互联网，连接和操作数据库的代码通常以一组函数和/或类的形式内置在框架中。这些函数/类对于大多数目的来说已经足够了，因为您只需向它们提供对数据库的命令(通常以 SQL 查询的形式)，它们就会以原始数据库行或许多受影响的行的形式向您返回结果。

今天，这被认为有点老派——相反，你应该使用某种框架，它将抽象出大量或者几乎所有的 SQL(或者你的数据库使用的任何语言)，允许你处理对象而不是数据库行。这类框架的例子包括 LINQ 到 SQL 和。NET 实体框架，后者存在于一个版本的核心。NET 框架也是(EF 核心)。

## ORM 对象关系映射

实体框架是所谓的 ORM——一种对象关系映射器。这将使数据库和代码之间的通信变得容易得多，因为您可能知道。NET 框架(以及许多其他编程语言/框架)使用对象，而关系数据库使用表来表示相同的东西。一个常见的场景是在数据库中有一个“Movies”表来表示一部或几部电影，在。NET 项目来表示在“Movies”表中找到的每部电影。

如果没有 ORM，您将负责表和对象之间的通信:当取出数据库行时，您将不得不手动填充电影对象，当插入数据时，您将不得不将电影对象的所有相关属性添加到 SQL 命令中，然后将它插入到数据库表中。

多亏了系统中的 ADO.NET 类，你仍然可以使用这种老式的方法。Data.SqlClient 命名空间。这将为您提供您所能想到的所有控制，但使用起来有点麻烦——您的对象和数据库表之间完全没有映射，即使是简单的操作也需要几行代码和使用几个类，如 SqlConnection、SqlCommand、SqlDataReader 等等。

<input type="hidden" name="IL_IN_ARTICLE">

另一方面，当您使用 ORM 时，您甚至可以用一行代码做很多事情，因为大量的功能已经被打包到短命令中。您不必编写任何 SQL——相反，您可以告诉框架您想用 Select()这样的命令完成什么，它会将它转换成目标数据库引擎能够理解的东西，例如 SQL，作为回报，您将收到现成的。NET 对象。

这样做的缺点是失去了很大的控制权:当您调用这些简单的命令时，框架决定如何最好地处理它们。当数据库的规模和复杂性开始增长时，您可能会看到很大的性能问题，因为 ORM 框架不能很好地理解您的数据和/或意图，无法将其转换成足够好地执行的命令。另一个缺点是，您可能甚至不明白为什么会发生这种情况，因为对于所有这些抽象，您不知道什么是数据库表，也不知道如何使用它。

## 挑选一个 ORM

在大多数 ASP.NET 教程中，尤其是与 MVC 相关的，你会看到使用了实体框架。这可能也是官方的，微软推荐的解决方案，但它不会是本教程中使用的。如上所述，这有几个很好的理由，但最重要的一个是我不太喜欢实体框架。我尝试过几次，但是我从来没有对我为易用性付出的失去控制感到舒服。另一个以不同方式做事的好理由是向您展示有多种选择，并且您可以获得巨大的灵活性。NET framework，总是有可能以不同的方式做事。

相反，我选择了非常抽象的实体框架和用 ADO 手工编码几乎所有东西之间的折衷。净:它被称为，通常被称为**微形**。它抽象出最无聊的事情，同时仍然允许你完全控制每件事是如何做的。

因此，使用 Dapper，您不必手动在表和对象之间进行映射，但是您仍然需要编写获取数据的 SQL。这也将允许您获得一些关于底层数据库及其工作方式的知识，这将使您在以后受益，特别是如果您开始从事更复杂、数据量大的项目。

关于 Dapper 的另一个很酷的事情是，它简单地扩展了 **IDbConnection** 接口，这意味着您可以使用现有的类来处理您选择的数据库(例如 SqlConnection，它实现了 IDB connection)——换句话说，如果。NET 支持您的数据库，并且您的数据库支持 SQL，您可能会使用 Dapper！

## 摘要

我们现在已经选择了一个数据库引擎(MS SQL Server)和一个数据库框架/ORM (Dapper)。有了这些，我们只需要做好一切准备，这样我们就可以开始构建数据库驱动的 TodoList web 应用程序了。在下一篇文章中会有更多的介绍。

* * *