# WPF 命令简介

> 原文:[https://wpf-tutorial.com/commands/introduction/](https://wpf-tutorial.com/commands/introduction/)

在本教程的前一章，我们讨论了如何处理事件，例如，当用户点击一个按钮或菜单项。在现代用户界面中，一个功能通常可以从几个地方访问，由不同的用户动作调用。

例如，如果您有一个带有主菜单和一组工具栏的典型界面，则像“新建”或“打开”这样的操作可能在菜单中、工具栏上、上下文菜单中(例如，当在主应用程序区域中右击时)以及从像 Ctrl+N 和 Ctrl+O 这样的键盘快捷键中可用。

这些动作中的每一个都需要执行通常完全相同的代码，所以在 WinForms 应用程序中，您必须为每个动作定义一个事件，然后调用一个公共函数。对于上面的例子，这将导致至少三个事件处理程序和一些代码来处理键盘快捷键。不是理想的情况。

## 命令

对于 WPF，微软试图用一个叫做命令的概念来补救。它允许您在一个地方定义动作，然后从所有用户界面控件(如菜单项、工具栏按钮等)中引用它们。WPF 还会监听键盘快捷键，并将其传递给适当的命令，如果有的话，这使得它成为在应用程序中提供键盘快捷键的理想方式。

当处理同一个功能的多个入口时，命令也解决了另一个麻烦。在 WinForms 应用程序中，当操作不可用时，您将负责编写可以禁用用户界面元素的代码。例如，如果您的应用程序能够使用剪贴板命令(如“剪切”),但仅当选择了文本时，您将不得不在每次文本选择改变时手动启用和禁用主菜单项、工具栏按钮和上下文菜单项。

<input type="hidden" name="IL_IN_ARTICLE">

使用 WPF 命令，这是集中的。有一种方法，你决定一个给定的命令是否可以执行，然后 WPF 自动切换所有订阅的界面元素。这使得创建一个响应迅速的动态应用程序变得更加容易！

## 命令绑定

命令本身实际上不做任何事情。在根上，它们由 ICommand 接口组成，该接口只定义了一个事件和两个方法:Execute()和 CanExecute()。第一个用于执行实际的动作，而第二个用于确定动作当前是否可用。要执行命令的实际操作，您需要在命令和代码之间建立一个链接，这就是 CommandBinding 发挥作用的地方。

CommandBinding 通常在窗口或 UserControl 上定义，并保存对它处理的命令的引用，以及用于处理命令的 Execute()和 CanExecute()事件的实际事件处理程序。

## 预定义的命令

你当然可以实现你自己的命令，我们将在下一章中探讨，但是为了让你更容易，WPF 团队已经定义了 100 多个你可以使用的常用命令。它们被分为 5 类，称为应用命令、导航命令、媒体命令、编辑命令和组件命令。尤其是 ApplicationCommands 包含了许多非常常用的操作命令，如新建、打开、保存和剪切、复制和粘贴。

## 摘要

命令有助于您使用单个事件处理程序响应来自多个不同来源的共同操作。它还使基于当前可用性和状态启用和禁用用户界面元素变得更加容易。这些都是理论，但是在接下来的章节中，我们将讨论如何使用命令以及如何定义你自己的定制命令。

* * *